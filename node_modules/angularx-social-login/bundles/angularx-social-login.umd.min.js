!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("angularx-social-login",["exports","@angular/core","rxjs","rxjs/operators","@angular/common"],t):t((e=e||self)["angularx-social-login"]={},e.ng.core,e.rxjs,e.rxjs.operators,e.ng.common)}(this,(function(e,t,n,i,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var u=function(){return(u=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,i){t(n,i,e)}}var l=function(){function e(e){var t=this;this.lazyLoad=!1,this.providers=new Map,this._ready=new n.ReplaySubject,n.isObservable(e)?e.pipe(i.first()).subscribe((function(e){t.initialize(e)})):this.initialize(e)}return e.prototype.initialize=function(e){for(var t=0;t<e.length;t++){var n=e[t];this.providers.set(n.id,n.provider),this.lazyLoad=this.lazyLoad||n.lazyLoad}this._ready.next(),this._ready.complete()},e}(),f=function(){function e(e){var t=this;this._user=null,this._authState=new n.ReplaySubject(1),this._readyState=new n.BehaviorSubject([]),this.initialized=!1,e._ready.subscribe((function(){t.providers=e.providers,e.lazyLoad||t.initialize()}))}var i;return i=e,Object.defineProperty(e.prototype,"authState",{get:function(){return this._authState.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._readyState.asObservable()},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){var e=this;this.initialized=!0,this.providers.forEach((function(t,n){t.initialize().then((function(){var i=e._readyState.getValue();i.push(n),e._readyState.next(i),t.getLoginStatus().then((function(t){t.provider=n,e._user=t,e._authState.next(t)})).catch((function(t){e._authState.next(null)}))}))}))},e.prototype.signIn=function(e,t){var n=this;return this.initialized||this.initialize(),new Promise((function(o,r){var a=n.providers.get(e);a?a.signIn(t).then((function(t){t.provider=e,o(t),n._user=t,n._authState.next(t)})).catch((function(e){r(e)})):r(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}))},e.prototype.signOut=function(e){var t=this;return void 0===e&&(e=!1),this.initialized||this.initialize(),new Promise((function(n,o){if(t._user){var r=t._user.provider,a=t.providers.get(r);a?a.signOut(e).then((function(){n(),t._user=null,t._authState.next(null)})).catch((function(e){o(e)})):o(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(i.ERR_NOT_LOGGED_IN)}))},e.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",e.ERR_NOT_LOGGED_IN="Not logged in",e.ctorParameters=function(){return[{type:l}]},e=i=c([t.Injectable()],e)}();var p=function(){function e(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}var n;return n=e,e.initialize=function(e){return{ngModule:n,providers:[f,{provide:l,useValue:e}]}},e.ctorParameters=function(){return[{type:e,decorators:[{type:t.Optional},{type:t.SkipSelf}]}]},e=n=c([t.NgModule({imports:[o.CommonModule],providers:[f]}),s(0,t.Optional()),s(0,t.SkipSelf())],e)}(),d=function(){},h=function(){function e(){this._readyState=new n.BehaviorSubject(!1)}return e.prototype.onReady=function(){var e=this;return new Promise((function(t,n){e._readyState.subscribe((function(e){e&&t()}))}))},e.prototype.loadScript=function(e,t,n,i,o){if(void 0===i&&(i=!0),void 0===o&&(o=""),"undefined"!=typeof document&&!document.getElementById(e)){var r=document.createElement("script");r.async=i,r.src=t,r.onload=n,document.head.appendChild(r)}},e}(),g=function(e){function t(t,n){void 0===n&&(n={scope:"email"});var i=e.call(this)||this;return i.clientId=t,i.opt=n,i}return a(t,e),t.prototype.initialize=function(){var e=this;return new Promise((function(n,i){e.loadScript(t.PROVIDER_ID,"https://apis.google.com/js/platform.js",(function(){gapi.load("auth2",(function(){e.auth2=gapi.auth2.init(u(u({},e.opt),{client_id:e.clientId})),e.auth2.then((function(){e._readyState.next(!0),n()})).catch((function(e){i(e)}))}))}))}))},t.prototype.getLoginStatus=function(){var e=this;return new Promise((function(t,n){e.onReady().then((function(){if(e.auth2.isSignedIn.get()){var i=new d,o=e.auth2.currentUser.get().getBasicProfile(),r=e.auth2.currentUser.get().getAuthResponse(!0).access_token,a=e.auth2.currentUser.get().getAuthResponse(!0).id_token;i.id=o.getId(),i.name=o.getName(),i.email=o.getEmail(),i.photoUrl=o.getImageUrl(),i.firstName=o.getGivenName(),i.lastName=o.getFamilyName(),i.authToken=r,i.idToken=a,t(i)}else n("No user is currently logged in.")}))}))},t.prototype.signIn=function(e){var t=this;return new Promise((function(n,i){t.onReady().then((function(){(e&&e.offline_access||t.opt&&t.opt.offline_access?t.auth2.grantOfflineAccess(e):t.auth2.signIn(e)).then((function(e){var i=new d,o=t.auth2.currentUser.get().getBasicProfile(),r=t.auth2.currentUser.get().getAuthResponse(!0).access_token,a=t.auth2.currentUser.get().getAuthResponse(!0).id_token;i.id=o.getId(),i.name=o.getName(),i.email=o.getEmail(),i.photoUrl=o.getImageUrl(),i.firstName=o.getGivenName(),i.lastName=o.getFamilyName(),i.authToken=r,i.idToken=a,e&&e.code&&(i.authorizationCode=e.code),n(i)}),(function(e){i("User cancelled login or did not fully authorize.")})).catch((function(e){i(e)}))}))}))},t.prototype.signOut=function(e){var t=this;return new Promise((function(n,i){t.onReady().then((function(){(e?t.auth2.disconnect():t.auth2.signOut()).then((function(e){e?i(e):n()})).catch((function(e){i(e)}))}))}))},t.PROVIDER_ID="GOOGLE",t}(h),m=function(e){function t(t,n,i,o,r){void 0===n&&(n={scope:"email,public_profile"}),void 0===i&&(i="en_US"),void 0===o&&(o="name,email,picture,first_name,last_name"),void 0===r&&(r="v4.0");var a=e.call(this)||this;return a.clientId=t,a.opt=n,a.locale=i,a.fields=o,a.version=r,a}return a(t,e),t.prototype.initialize=function(){var e=this;return new Promise((function(n,i){e.loadScript(t.PROVIDER_ID,"//connect.facebook.net/"+e.locale+"/sdk.js",(function(){FB.init({appId:e.clientId,autoLogAppEvents:!0,cookie:!0,xfbml:!0,version:e.version}),e._readyState.next(!0),n()}))}))},t.prototype.getLoginStatus=function(){var e=this;return new Promise((function(t,n){e.onReady().then((function(){FB.getLoginStatus((function(i){if("connected"===i.status){var o=i.authResponse;FB.api("/me?fields="+e.fields,(function(e){var n=new d;n.id=e.id,n.name=e.name,n.email=e.email,n.photoUrl="https://graph.facebook.com/"+e.id+"/picture?type=normal",n.firstName=e.first_name,n.lastName=e.last_name,n.authToken=o.accessToken,n.facebook=e,t(n)}))}else n("No user is currently logged in.")}))}))}))},t.prototype.signIn=function(e){var t=this;return new Promise((function(e,n){t.onReady().then((function(){FB.login((function(i){if(i.authResponse){var o=i.authResponse;FB.api("/me?fields="+t.fields,(function(t){var n=new d;n.id=t.id,n.name=t.name,n.email=t.email,n.photoUrl="https://graph.facebook.com/"+t.id+"/picture?type=normal",n.firstName=t.first_name,n.lastName=t.last_name,n.authToken=o.accessToken,n.facebook=t,e(n)}))}else n("User cancelled login or did not fully authorize.")}),t.opt)}))}))},t.prototype.signOut=function(){var e=this;return new Promise((function(t,n){e.onReady().then((function(){FB.logout((function(e){t()}))}))}))},t.PROVIDER_ID="FACEBOOK",t}(h);e.AuthService=f,e.AuthServiceConfig=l,e.FacebookLoginProvider=m,e.GoogleLoginProvider=g,e.SocialLoginModule=p,e.SocialUser=d,e.Éµa=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angularx-social-login.umd.min.js.map